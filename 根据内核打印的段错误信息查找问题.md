##根据内核打印的段错误信息OOPs查找问题

####分析输出日志

	[  599.339014] virnet_dev is ok!
	[  599.339080] Unable to handle kernel NULL pointer dereference at virtual address 00000000
							内核使用00000000时发生了错误，也就是空指针
	[  599.339152] pgd = cfe5c000
	[  599.339179] [00000000] *pgd=2ec8a031, *pte=00000000, *ppte=00000000
	[  599.339242] Internal error: Oops: 17 [#1] PREEMPT
	[  599.341368] last sysfs file: /sys/devices/virtual/vc/vcsa4/dev
	[  599.347174] Modules linked in: virt_net_fir(+) libertas_sdio libertas zd1211rw rt2800usb rt2800lib rt73usb rt2x00usb rt2x00lib ath9k_htc mac80211 ath9k_common ath9k_hw ath cfg80211 compat rtl8192cu tvp5150_tiny210 easycap ov9650 snd_soc_mini210_wm8960 snd_soc_wm8960
	[  599.370661] CPU: 0    Not tainted  (2.6.35.7-FriendlyARM #1)
	[  599.376304] PC is at register_netdevice+0xe4(该指令的偏移地址)/0x40c(该函数的总大小)
							 PC就是发生错误的指令的地址
	[  599.381059] LR is at register_netdevice+0xd4/0x40c
							 LR寄存器的值
	[  599.385827] pc : [<c04d88c4>]    lr : [<c04d88b4>]    psr: 60000013
	[  599.385832] sp : cec8fef0  ip : cec8fef0  fp : cec8ff1c
	[  599.397263] r10: 00000000  r9 : cec8e000  r8 : ffffffff
	[  599.402463] r7 : ced08080  r6 : 00000001  r5 : 00000034  r4 : ced12800
	[  599.408962] r3 : 00000000  r2 : c0992218  r1 : c07dd2fe  r0 : ced129a0
	执行这条导致错误的指令时各个寄存器的值
							
	[  599.415462] Flags: nZCv  IRQs on  FIQs on  Mode SVC_32  ISA ARM  Segment user
	[  599.422567] Control: 10c5387d  Table: 2fe5c019  DAC: 00000015
	[  599.428285] 
	[  599.428288] PC: 0xc04d8844:
	[  599.432530] 8844  e3550000 0a000002 e59f0368 e3011363 ebf2692c e2840f43 e59f1360 e59f2360
	[  599.440676] 8864  ebf9281f e1a06005 e3e08000 ea000008 e59471c4 e59f134c e0877005 e2870010
	[  599.448822] 8884  e59f2344 ebf92816 e2866001 e5878020 e2855034 e59431c8 e1560003 3afffff3
	[  599.456967] 88a4  e2840e1a e59f131c e59f231c ebf9280c e3e03000 e58431b0 e5843058 e59430c0
	[  599.465113] 88c4  e5933000 e3530000 0a000005 e1a00004 e12fff33 e2505000 0a000001 da0000aa
	[  599.473259] 88e4  ea0000a8 e1a00004 e1a01004 e3a02000 ebfffdcd e2505000 e1a06004 1a0000a5
	[  599.481404] 8904  e59f52c8 e3a08001 e5953230 e59f02c0 e2833001 e3530000 d1a03008 e5853230
	[  599.489550] 8924  e1a01003 e1a07003 ebffef53 e3500000 1afffff4 e5943058 e5847054 e3730001
	[  599.497697] 
	[  599.497700] LR: 0xc04d8834:
	[  599.501942] 8834  e3a02000 ebf2db9b e3a03f8a e19450b3 e3550000 0a000002 e59f0368 e3011363
	[  599.510088] 8854  ebf2692c e2840f43 e59f1360 e59f2360 ebf9281f e1a06005 e3e08000 ea000008
	[  599.518234] 8874  e59471c4 e59f134c e0877005 e2870010 e59f2344 ebf92816 e2866001 e5878020
	[  599.526379] 8894  e2855034 e59431c8 e1560003 3afffff3 e2840e1a e59f131c e59f231c ebf9280c
	[  599.534525] 88b4  e3e03000 e58431b0 e5843058 e59430c0 e5933000 e3530000 0a000005 e1a00004
	[  599.542671] 88d4  e12fff33 e2505000 0a000001 da0000aa ea0000a8 e1a00004 e1a01004 e3a02000
	[  599.550817] 88f4  ebfffdcd e2505000 e1a06004 1a0000a5 e59f52c8 e3a08001 e5953230 e59f02c0
	[  599.558962] 8914  e2833001 e3530000 d1a03008 e5853230 e1a01003 e1a07003 ebffef53 e3500000
	[  599.567109] 
	[  599.567112] SP: 0xcec8fe70:
	[  599.571354] fe70  c0b794e0 00000010 ff0a0210 ffffffff c01d8f44 ffffffff cec8fedc 00000001
	[  599.579500] fe90  ced08080 ffffffff cec8ff1c cec8fea8 c016ea6c c016e21c ced129a0 c07dd2fe
	[  599.587646] feb0  c0992218 00000000 ced12800 00000034 00000001 ced08080 ffffffff cec8e000
	[  599.595791] fed0  00000000 cec8ff1c cec8fef0 cec8fef0 c04d88b4 c04d88c4 60000013 ffffffff
	[  599.603937] fef0  c05e31cc ced12800 00000000 ced12800 00000000 bf341000 00000000 c016f168
	[  599.612083] ff10  cec8ff34 cec8ff20 c04d8c30 c04d87ec bf34129c 00000000 cec8ff4c cec8ff38
	[  599.620229] ff30  bf34109c c04d8bf8 cec8e000 bf341178 cec8ff7c cec8ff50 c016e4b8 bf34100c
	[  599.628374] ff50  000afa95 0001fe0c cec8ff7c cec8ff68 bf341178 00000000 000afa95 0001fe0c
	[  599.636521] 
	[  599.636523] IP: 0xcec8fe70:
	[  599.640766] fe70  c0b794e0 00000010 ff0a0210 ffffffff c01d8f44 ffffffff cec8fedc 00000001
	[  599.648912] fe90  ced08080 ffffffff cec8ff1c cec8fea8 c016ea6c c016e21c ced129a0 c07dd2fe
	[  599.657058] feb0  c0992218 00000000 ced12800 00000034 00000001 ced08080 ffffffff cec8e000
	[  599.665203] fed0  00000000 cec8ff1c cec8fef0 cec8fef0 c04d88b4 c04d88c4 60000013 ffffffff
	[  599.673349] fef0  c05e31cc ced12800 00000000 ced12800 00000000 bf341000 00000000 c016f168
	[  599.681495] ff10  cec8ff34 cec8ff20 c04d8c30 c04d87ec bf34129c 00000000 cec8ff4c cec8ff38
	[  599.689641] ff30  bf34109c c04d8bf8 cec8e000 bf341178 cec8ff7c cec8ff50 c016e4b8 bf34100c
	[  599.697786] ff50  000afa95 0001fe0c cec8ff7c cec8ff68 bf341178 00000000 000afa95 0001fe0c
	[  599.705933] 
	[  599.705935] FP: 0xcec8fe9c:
	[  599.710178] fe9c  cec8fea8 c016ea6c c016e21c ced129a0 c07dd2fe c0992218 00000000 ced12800
	[  599.718324] febc  00000034 00000001 ced08080 ffffffff cec8e000 00000000 cec8ff1c cec8fef0
	[  599.726470] fedc  cec8fef0 c04d88b4 c04d88c4 60000013 ffffffff c05e31cc ced12800 00000000
	[  599.734616] fefc  ced12800 00000000 bf341000 00000000 c016f168 cec8ff34 cec8ff20 c04d8c30
	[  599.742761] ff1c  c04d87ec bf34129c 00000000 cec8ff4c cec8ff38 bf34109c c04d8bf8 cec8e000
	[  599.750907] ff3c  bf341178 cec8ff7c cec8ff50 c016e4b8 bf34100c 000afa95 0001fe0c cec8ff7c
	[  599.759053] ff5c  cec8ff68 bf341178 00000000 000afa95 0001fe0c cec8ffa4 cec8ff80 c01c3244
	[  599.767198] ff7c  c016e45c c01f7bd8 c01f7ae4 00000001 00000069 bebb2de4 00000080 00000000
	[  599.775345] 
	[  599.775347] R0: 0xced12920:
	[  599.779590] 2920  ced1291c 00000000 ced12928 ced12928 00000000 00000000 00000000 00000000
	[  599.787736] 2940  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  599.795882] 2960  ced08848 ced08840 ced08840 00000001 ffffffff 0000ffff 00000000 00000000
	[  599.804028] 2980  00000000 00000000 00000000 00000000 ced12800 00000000 00000000 00000000
	[  599.812173] 29a0  00000001 dead4ead ffffffff ffffffff ffffffff 00000000 00000000 00000000
	[  599.820319] 29c0  00000000 ced08080 00000001 00000001 00000000 000003e8 00000001 dead4ead
	[  599.828465] 29e0  ffffffff ffffffff 00000000 00000000 00000000 00000000 00000000 00000000
	[  599.836610] 2a00  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  599.844757] 
	[  599.844760] R1: 0xc07dd27e:
	[  599.849002] d27c  72726520 72642073 6620706f 206f6669 6c6c6f63 61632073 65697272 6f632072
	[  599.857148] d29c  6572706d 64657373 3625000a 25203a73 20756c37 756c3725 6c342520 34252075
	[  599.865294] d2bc  2520756c 20756c34 756c3525 30312520 2520756c 20756c39 756c3825 6c372520
	[  599.873440] d2dc  34252075 2520756c 20756c34 756c3425 6c352520 37252075 2520756c 756c3031
	[  599.881585] d2fc  2826000a 76656426 6575715f 3e2d6575 696d785f 6f6c5f74 2d296b63 6f6c723e
	[  599.889731] d31c  65006b63 7265746e 6c006465 00746665 253e343c 70203a73 696d6f72 69756373
	[  599.897877] d33c  74207974 6863756f 72207365 2c666f6f 74657320 6f727020 6373696d 79746975
	[  599.906022] d35c  69616620 2c64656c 6f727020 6373696d 79746975 61656620 65727574 20666f20
	[  599.914168] d37c  69766564 6d206563 74686769 20656220 6b6f7262 0a2e6e65 3e363c00 69766564
	[  599.922315] 
	[  599.922317] R2: 0xc0992198:
	[  599.926560] 2198  c094fe44 c099219c c099219c c09921a4 c09921a4 c09921ac c09921ac c09921b4
	[  599.934706] 21b8  c09921b4 c09921bc c09921bc c094f8a0 c094f8a0 c09921cc c09921cc c09921d4
	[  599.942852] 21d8  c09921d4 c09921dc c09921dc c09921e4 c09921e4 c09921ec c09921ec c09921f4
	[  599.950997] 21f8  c09921f4 c0951fd8 c0951fd8 c0992204 c0992204 c099220c c099220c 232dcd9f
	[  599.959143] 2218  00000000 c094b564 00000000 00000000 00000000 00000000 00000000 00000000
	[  599.967289] 2238  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  599.975435] 2258  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  599.983580] 2278  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  599.991727] 
	[  599.991730] R4: 0xced12780:
	[  599.995972] 2780  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  600.004118] 27a0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  600.012264] 27c0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  600.020409] 27e0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  600.028555] 2800  6e726976 00307465 00000000 00000000 00000000 00000000 00000000 00000000
	[  600.036701] 2820  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  600.044846] 2840  ced12840 ced12840 ced12848 ced12848 00000004 00000000 ffffffff 00000000
	[  600.052992] 2860  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  600.061139] 
	[  600.061142] R7: 0xced08000:
	[  600.065384] 8000  00000002 00000000 cecdcbb0 cecdcbbc 00000000 cecdcda0 c01aac5c 000000dd
	[  600.073530] 8020  c0820020 00000000 c3fbc518 00000000 00000000 00000000 00000000 00000000
	[  600.081676] 8040  00000001 00000000 cecdd2b0 00000000 00000000 00000000 cf4be000 000000d2
	[  600.089822] 8060  c0820020 00000000 c3fbcb90 00000000 00000000 00000000 00000000 00000000
	[  600.097967] 8080  ced12800 00000000 00000000 00000000 00000001 dead4ead ffffffff ffffffff
	[  600.106113] 80a0  ffffffff 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  600.114259] 80c0  e0fb3000 e0fd4000 00000005 cec8d24c 00000000 00000000 cff62298 cec8d258
	[  600.122404] 80e0  c04c6574 00000000 ced08080 00000000 00000000 00000000 00000000 00000000
	[  600.130551] 
	[  600.130554] R9: 0xcec8df80:
	[  600.134796] df80  00000000 cec8dfc0 00000001 00000001 00000000 00000000 00000000 00000000
	[  600.142942] dfa0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  600.151088] dfc0  cf6df140 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  600.159233] dfe0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  600.167379] e000  00000000 00000002 00000000 cecdca80 c081e7d0 00000000 00000017 c081e2b8
	[  600.175525] e020  cec8e000 00000000 cecdca80 cecdc700 cecc9700 00000000 cec8fd9c cec8fd70
	[  600.183671] e040  c05e1d48 00000000 00000000 00000000 00000000 00000000 01000000 00000000
	[  600.191816] e060  4001e740 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	[  600.199965] Process insmod (pid: 221, stack limit = 0xcec8e2f0)
	[  600.205858] Stack: (0xcec8fef0 to 0xcec90000)
	[  600.210193] fee0:                                     c05e31cc ced12800 00000000 ced12800
	[  600.218340] ff00: 00000000 bf341000 00000000 c016f168 cec8ff34 cec8ff20 c04d8c30 c04d87ec
	[  600.226486] ff20: bf34129c 00000000 cec8ff4c cec8ff38 bf34109c c04d8bf8 cec8e000 bf341178
	[  600.234632] ff40: cec8ff7c cec8ff50 c016e4b8 bf34100c 000afa95 0001fe0c cec8ff7c cec8ff68
	[  600.242777] ff60: bf341178 00000000 000afa95 0001fe0c cec8ffa4 cec8ff80 c01c3244 c016e45c
	[  600.250923] ff80: c01f7bd8 c01f7ae4 00000001 00000069 bebb2de4 00000080 00000000 cec8ffa8
	[  600.259069] ffa0: c016efc0 c01c31b4 00000001 00000069 000bc040 0001fe0c 000afa95 7fffffff
	[  600.267214] ffc0: 00000001 00000069 bebb2de4 00000080 bebb2de8 000afa95 bebb2de8 00000000
	[  600.275360] ffe0: 00000001 bebb2a8c 0001cb50 40194664 60000010 000bc040 20bb2021 20bb2421
	
	[  600.283500] Backtrace: (回溯：在.config文件里面只有定义了这个宏CONFIG_FRAME_POINTER=y，才会打印回溯信息)
	[  600.285935] [<c04d87e0>] (register_netdevice+0x0/0x40c) from [<c04d8c30>] (register_netdev+0x44/0x54)
	[  600.295113]  r8:c016f168 r7:00000000 r6:bf341000 r5:00000000 r4:ced12800
	[  600.301796] [<c04d8bec>] (register_netdev+0x0/0x54) from [<bf34109c>] (virt_net_init+0x9c/0xe0 [virt_net_fir])
	[  600.311750]  r5:00000000 r4:bf34129c
	[  600.315315] [<bf341000>] (virt_net_init+0x0/0xe0 [virt_net_fir]) from [<c016e4b8>] (do_one_initcall+0x68/0x1b0)
	[  600.325356]  r4:bf341178 r3:cec8e000
	[  600.328916] [<c016e450>] (do_one_initcall+0x0/0x1b0) from [<c01c3244>] (sys_init_module+0x9c/0x1b4)
	[  600.337921]  r7:0001fe0c r6:000afa95 r5:00000000 r4:bf341178
	[  600.343560] [<c01c31a8>] (sys_init_module+0x0/0x1b4) from [<c016efc0>] (ret_fast_syscall+0x0/0x30)
	[  600.352479]  r7:00000080 r6:bebb2de4 r5:00000069 r4:00000001
	[  600.358117] Code: e3e03000 e58431b0 e5843058 e59430c0 (e5933000) 
	[  600.369104] ---[ end trace 5b04257d5b7e367d ]---
	Segmentation fault



####根据PC值找到导致错误的指令

由错误日志可以得出PC = 0xc04d88c4。

1. 内核地址还是insmod加载的模块地址：在内核根目录找到文件System.map，可以知道内核的目录范围，进而可以判断内核地址范围`c0004000 - c099c370`,PC在内核地址范围内就是内核地址，否则就是insmod模块地址。(注：属于内核地址说明这个函数的的定义在内核中，但有可能在模块中被调用，在调用的过程中出现了内存错误)

2. 如果是模块，属于哪个驱动模块：`cat /proc/kallsyms`（内核所有函数变量的地址），可以在这个文件中搜索略小于PC的地址，PC就属于这个函数内的指令。(注：有些打印错误信息的会把模块名打印出来，但有些真正使用的内核却不)
3. 如果是内核地址，基本上在System.map文件里面就可以找到PC所在的函数的地址。

4. 反汇编：如果属于内核地址，反汇编内核(arm-linux-objdump -D vmlinux > linux.dis)，如果属于模块地址(arm-linux-objdump -D virt_net_fir.ko > virt_net_fir.dis)，反汇编模块，在反汇编文件里面搜索刚刚找到的函数名。在上一步可以知道PC相对pc所以函数的偏移地址，在搜索到函数后，就可以通过函数地址以及偏移地址找到出错的指令。











	

